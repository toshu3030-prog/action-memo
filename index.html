<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>æ—¥æ¬¡è¡Œå‹•ãƒ¡ãƒ¢ï¼ˆå…±æœ‰ä¿å­˜ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f7;
      margin: 0;
      padding: 16px;
    }
    .card {
      max-width: 640px;
      margin: auto;
      background: white;
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    h1 {
      font-size: 18px;
      margin-bottom: 12px;
    }
    input[type="date"] {ï¿¥ï¿¥
      width: 100%;
      font-size: 16px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-bottom: 10px;
    }
    textarea {
      width: 100%;
      height: 220px;
      font-size: 16px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      margin-top: 10px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: none;
      border-radius: 12px;
      background: #007aff;
      color: white;
      cursor: pointer;
    }
    .secondary {
      background: #e5e5ea;
      color: #000;
    }
    .note {
      margin-top: 10px;
      font-size: 13px;
      color: #555;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ“ æ—¥æ¬¡è¡Œå‹•ãƒ¡ãƒ¢</h1>

    <input type="date" id="date" />

    <textarea id="content" placeholder="ä»Šæ—¥ã‚„ã£ãŸã“ã¨ã‚’è‡ªç”±ã«æ›¸ã"></textarea>

    <button onclick="shareText()">å…±æœ‰ã—ã¦ä¿å­˜ï¼ˆiCloudæŒ‡å®šï¼‰</button>
    <button class="secondary" onclick="loadFile()">éå»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€</button>

    <p class="note">â€» ä¿å­˜æ™‚ã¯ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã€ã‚’é¸ã³ã€iCloud Drive å†…ã®ä»»æ„ãƒ•ã‚©ãƒ«ãƒ€ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚</p>

    <input type="file" id="fileInput" accept=".txt" style="display:none" />
  </div>

  <script>
    const dateInput = document.getElementById('date');
    const content = document.getElementById('content');
    const fileInput = document.getElementById('fileInput');

    // åˆæœŸæ—¥ä»˜ã¯ã€Œé–‹ã„ãŸå½“æ—¥ã€ã«å¿…ãšã‚»ãƒƒãƒˆ
function setToday() {
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, '0');
  const dd = String(today.getDate()).padStart(2, '0');
  dateInput.value = `${yyyy}-${mm}-${dd}`;
}

// åˆå›è¡¨ç¤ºæ™‚ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰å«ã‚€ï¼‰ã¯å½“æ—¥ã‚’ã‚»ãƒƒãƒˆ
document.addEventListener('DOMContentLoaded', setToday);
});

    async function shareText() {
      const date = dateInput.value;
      const text = content.value;

      if (!text.trim()) {
        alert('å†…å®¹ãŒç©ºã§ã™');
        return;
      }

      const file = new File([text], `${date}.txt`, { type: 'text/plain' });

      if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({
          files: [file],
          title: `${date} è¡Œå‹•ãƒ¡ãƒ¢`,
          text: text
        });
      } else {
        alert('ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯å…±æœ‰ä¿å­˜ãŒä½¿ãˆã¾ã›ã‚“ã€‚iPhoneã®Safariã§é–‹ã„ã¦ãã ã•ã„ã€‚');
      }
    }

    function loadFile() {
      fileInput.click();
    }

    fileInput.addEventListener('change', () => {
      const file = fileInput.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        content.value = reader.result;
      };
      reader.readAsText(file);
    });
  </script>
</body>
</html>
